# Домашнее задание к занятию «Резервное копирование» - `Станик Александр`

### Задание 1
1.1 Восстановление данных в полном объёме за предыдущий день
- Для этого случая подходит полное резервное копирование. То есть делается полная копия БД на определённый момент, например в 23:00, когда пользователи не работают в системе и можно остановить все задачи по записи в БД. Это позволяет восстановить БД актуальностью начиная с прошлого дня. Данный метод требует значительных затрат на реурсы сервера в плане дискового пространства (так же зависит какое количество копий необходимо хранить), а так же не позволяет работать с БД на момент осуществления резервного копирования или восстановления.

1.2 Восстановление данных за час до предполагаемой поломки
- Для этого случая рекомендуется использовать дифференциальное резервное копирование или инкрементальное резервное копирование.
Дифференциальное резервное копирование сохраняет все изменения, внесённые с момента последнего полного резерва. 
Инкрементальное резервное копирование сохраняет только те изменения, которые были внесены с момента последнего инкрементального резерва. Это позволяет восстанавливать данные по частям, что может быть полезно для быстрого восстановления части данных.
Эти методы позволяют восстановить данные до определённой точки времени, например актуальностью за прошлый час. Так же оба метода не требуют ограничений при работе с БД во время резервирования, так как они резервируют только изменения, а не всю БД.

1.3 Моментальное переключение на работающую или починенную БД
-Для моментального переключения можно использовать стратегию горячего резервного копирования. Это означает, что есть вторая БД, которая постоянно синхронизируется с основной. При поломке основной базы горячий резерв может быть моментально активирован и продолжить работу без потери данных. Также можно использовать репликацию, чтобы автоматически синхронизировать данные между основной БД и её копией. Это обеспечивает высокую доступность и позволяет быстро переключиться на резервную БД в случае поломки.

### Задание 2
2.1
- Для создания резервной копии БД можно использовать утилиту pg_dump:
  pg_dump -U postgres -h localhost dbname > backup.dump
  -U postgres- мы указываем имя пользователя от котороо выполняем операцию;
  -h localhost - указываем хост с БД;
  dbname - имя БД;
  > backup.dump - название файла в который будет сохранена резервная копия.
- Для восстановления БД из резервной копии используем утилиту pg_restore:
  pg_restore -U postgres -h localhost -d dbname backup.dump
  -U postgres- мы указываем имя пользователя от котороо выполняем операцию;
  -h localhost - указываем хост на котором будем восстанавливать БД;
  dbname - имя целевой БД;
  backup.dump - имя файла с резервной копией.

  ### Задание 3
  Для настройки инкрементного резервного копирования в MySQL необходимо:
  - Включить бинарное логирование, через конфигурационный файл my.cnf в раздел mysqld добавить строки:
      log-bin = /path/to/binary_log
      binlog_format = ROW
    и перезапустить экземпляр.
  - Создадим полную резервную копию при помощи mysqldump:
       mysqldump -u username -p --single-transaction --flush-logs --master-data=2 --databases your_database > full_backup.sql
      Где --single-transaction используется для создания копии без блокировки таблиц, а --flush-logs закрыввает текущий бинарный лог и открывает новый, и --master-data=2 добавляет в резервную копию информацию о текущем бинарном логе.
  - Далее делаем при помощи mysqlbinlog делаем инкрементное резервное копирование: 
       mysqlbinlog --start-position=4 --stop-position=1000 /var/lib/mysql/mysql-bin.000001 > incremental_backup.sql
      Где --start-position указывает на позицию, с которой начинать резервное копирование, --stop-position показывает конечню точку в бинарном логе по которую копировать, ну а /var/lib/mysql/mysql-bin.000001 путь к бинарному логу.

